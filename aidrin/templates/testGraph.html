<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GraphTesting</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <div id="charts"></div>
  <script>
    // Simulated numerical data
    const data = {
        column1: [1, 2, 2, 3, 3, 3, 4, 4, 5, 6, 7, 8, 9],
        column2: [10, 15, 14, 18, 22, 30, 25, 27, 24, 19, 16, 13],
        column3: [0,5000,10000,15000,20000,25000,30000]
    };
    
    const width = 400, height = 300, margin = 50;

    Object.keys(data).forEach(column => {
        const values = data[column].sort(d3.ascending);
        const density = kernelDensityEstimator(kernelEpanechnikov(7), d3.scaleLinear().domain(d3.extent(values)).ticks(40))(values);

        // Define scales
        const xScale = d3.scaleLinear().domain(d3.extent(values)).range([margin, width - margin]);
        const yScale = d3.scaleLinear().domain([0, d3.max(density, d => d[1])]).range([height - margin, margin]);

        // Create SVG container
        const svg = d3.select("#charts")
            .append("svg")
            .attr("width", width)
            .attr("height", height)
            .attr("class", "chart");

        // Add density line (thicker stroke)
        svg.append("path")
            .datum(density)
            .attr("fill", "none")
            .attr("stroke", "steelblue")
            .attr("stroke-width", 3)  // Thicker line
            .attr("opacity", 0.9)  // Improve visibility
            .attr("d", d3.line()
                .curve(d3.curveBasis)
                .x(d => xScale(d[0]))
                .y(d => yScale(d[1]))
            );

        // Add X-axis
        svg.append("g")
            .attr("transform", `translate(0,${height - margin})`)
            .call(d3.axisBottom(xScale));

        // Add Y-axis
        svg.append("g")
            .attr("transform", `translate(${margin},0)`)
            .call(d3.axisLeft(yScale));

        // Add title
        svg.append("text")
            .attr("x", width / 2)
            .attr("y", 20)
            .attr("text-anchor", "middle")
            .style("font-size", "14px")
            .text(`Distribution Estimate for ${column}`);
    });

    // Kernel Density Estimation function
    function kernelDensityEstimator(kernel, X) {
        return function(V) {
            return X.map(x => [x, d3.mean(V, v => kernel(x - v))]);
        };
    }

    function kernelEpanechnikov(k) {
        return function(v) {
            return Math.abs(v /= k) <= 1 ? 0.75 * (1 - v * v) / k : 0;
        };
    }
  </script>
</body>
</html>
